% LMS.m - We want to input a color direction in LMS space and get out% the associated RGB direction, as well as the maximum contrast for that% direction.% Color direction in LMS coordinatesincLMS = [0.1 0.1331 0]';%%%%% Load the necessary files%% This is the relevant monitor spectrum.  This file includes the variables:% monitorSpectra, which runs from 380-730 and has 4 dimensions representing% r, g, b, and white.load([machineName,':Applications:Matlab 5.2:MRI:GammaTables:NecLcd2000Spectra.mat']);monitorRGBspectra = monitorSpectra(:,1:3);if ~exist('coneSpectra')	load coneSpectra;	% These run from 370-730, so remove first ten	coneSpectra = coneSpectra(11:361,:);end% These are the matrices to convert between RGB and LMSRGB2LMS = coneSpectra' * monitorRGBspectra;LMS2RGB = inv(RGB2LMS);% This is here to figure out the LMS background values.bkgRGB = [0.5 0.5 0.5]';bkgLMS = RGB2LMS * bkgRGB;% This routine returns the scale factor that puts% the vector into the values between 1.0 and 0.0[maxOffset,meanRGB]=maxConeContrast(bkgLMS, incLMS,...								   monitorRGBspectra, coneSpectra);incLMSmax = maxOffset * incLMS;incRGB = LMS2RGB * incLMSmax;RGBdir = 2*incRGBmaxContrast = floor (10000*max (incLMSmax ./ bkgLMS))/10000