function framesPerBlit = testTiming(stimulus)%framesPerBlit = testTiming(imageSize)%ShowStimulusDemorunPriority = 7;  %0 for low priority, 7 for high priorityclear params%Grating stimulus parameters.params.size = size(stimulus.image(:,:,1));params.duration = 10;params.duration  = input('duration (sec)')%Generate display structure%monitor = 'SanyoLCD';monitor = 'NecLcd2000';%monitor = 'Multiscan720';%position = 'outside bore';position = 'room 452';card = 'Radius10-bit';%card = 'BuiltIn8-bit';%resolution = '640x480, 67Hz';%resolution = '832x624, 75Hz';resolution = '1280x1024, 74Hz';display = initDisplayStruct(monitor,card,resolution,position);display.screenNumber =input('Screen number (0 or 1)');   %should be 0 or 1%Generate a simple stimulus.m = params.size(2);n = params.size(1);nFrames = getFrames(display,params.duration);img = zeros(m,n,2);img(:,:,1) = ones(m,n);img(:,:,2) = 2*ones(m,n);stimulus = createStimulusStruct(img,greyCmap(display),[mod(1:nFrames,2)+1]);%Open the screendisplay = openScreen(display);%Store the images off screenstimulus=createImagePointers(display,stimulus);%show the stimulustiming = showStimulus(display,stimulus,runPriority,0);disp(['Expected duration:  ',num2str(params.duration),' seconds.']);disp(['Recorded duration:  ',num2str(timing),' seconds.']);disp(['Extra frames:       ',num2str(getFrames(display,timing)-nFrames)]);disp(['Recorded frame rate:',num2str(getFrames(display,timing)/params.duration),' Hz']);framesPerBlit = getFrames(display,timing)/nFrames;disp(['Frames per blit:    ',num2str(framesPerBlit)]);%Close the one on-screen and many off-screen windowsSCREEN('CloseAll');