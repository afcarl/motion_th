function [scanIndex, resultPathname] = UpdateResults_OSX(baseName, stimParams, scanHistory, newSession)% First, move to the correct directory:cd('/Applications/MATLAB_R2007b/toolbox/matlab/michael_silver/Results');% Next, make the file name from today's date and the base name input:dstr = datestr(datenum(now), 2);dstr(findstr(dstr, '/')) = '';dataSumName = [baseName, stimParams.id, dstr]filecounter = 1; allfilesfound = 0;while allfilesfound == 0 %find most recent results file    testdataSumName = [dataSumName, '_', num2str(filecounter)];    eval('load(testdataSumName)', 'allfilesfound = 1; filecounter = filecounter - 1;');     filecounter = filecounter +1;endif newSession == 0 %continuing session    dataSumName = [dataSumName,'_',num2str(filecounter-1)];    load(dataSumName);    scanIndex = scanIndex + 1;    dispString = ['Data file ' dataSumName ' updated with scan #', num2str(scanIndex)];else  dataSumName = testdataSumName;  scanIndex = 1;  dispString = ['New data file ' dataSumName ' saved'];  clear results;endresults(scanIndex).scanHistory = scanHistory;results(scanIndex).stimParams = stimParams;results(scanIndex).time = datestr(datenum(now));save(dataSumName, 'results', 'scanIndex');disp(dispString);%cd(myDir)   % added by Ben 7/26%resultPathname = dataSumName;