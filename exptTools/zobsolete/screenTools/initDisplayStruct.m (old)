function display = initDisplayStruct(monitor,card,resolution,position)%display = initDisplayStruct(monitor,resolution,card,position)%%  Initializes a display structure with conditions defined by properties.%  Property options are:%%  Monitor properties:%    'SanyoLCD'       			%    'RadiusGrayscale'%    'Multiscan720'%    'NecLcd2000'%%  Graphics card properites:%    'AV';%    'Radius10-bit'%    'BuiltIn8-bit'%%  Resolution properties:%    '640x480, 60Hz'%    '640x480, 67Hz'%    '800x600, 60Hz'%    '832x624, 75Hz'%    '1024x768, 60Hz'%    '1024x768, 75Hz'%%  Screen position properties:%    'room 454';%    'room 452';%    'outside bore'%    'inside bore'%    'shielded box'%%  Note: not all combinations of monitor, card, resolution and position are allowed.%1/22/98 gmb  Wrote it.clear displaydisplay.monitor = monitor;display.card = card;display.resolution = resolution;display.position = position;display.screenNumber=0;display.numColors = 256;display.reservedColor(1).name='background';display.reservedColor(1).fbVal = 0;display.reservedColor(1).gunVal = [127,127,127];display.reservedColor(2).name='black';display.reservedColor(2).fbVal = 1;display.reservedColor(2).gunVal = [0,0,0];display.reservedColor(3).name='white';display.reservedColor(3).fbVal = 2;display.reservedColor(3).gunVal = [255,255,255];if strcmp(card,'AV')	display.pixelDepth = 8;elseif strcmp(card,'BuiltIn8-bit')	display.pixelDepth = 8;elseif strcmp(card,'Radius10-bit')	display.pixelDepth = 10;endif strcmp(position,'room 454')	display.distance = 50;endif strcmp(monitor,'SanyoLCD') 	if strcmp(position,'outside bore')		display.distance = 127.5;		display.pixelSize = 0.0691;	elseif strcmp(position,'inside bore')		display.distance = 21.5;		display.pixelSize = 0.0825;	else		disp(['display position property "',position,'" not recognized for monitor "',monitor,'".']);	end	if strcmp(resolution,'640x480, 67Hz')		display.frameRate = 200/3;		else		disp(['display resolution property "',resolution,'" not recognized for monitor "',monitor,'".']);	endelseif strcmp(monitor,'Multiscan720') 	if strcmp(position,'room 452')		display.distance = 40;	else		disp(['display position property "',position,'" not recognized for monitor "',monitor,'".']);	end	if strcmp(resolution,'640x480, 60Hz')		display.pixelSize = 0.0450;		display.frameRate = 60;		elseif strcmp(resolution,'640x480, 67Hz')		display.pixelSize = 0.0450;		display.frameRate = 200/3;	elseif strcmp(resolution,'800x600, 60Hz')		display.pixelSize = 0.03750;		display.frameRate = 60;	elseif strcmp(resolution,'832x624, 75Hz')		display.pixelSize = 0.03620;		display.frameRate = 75;	elseif strcmp(monitor,'Apple multiscan 720') & strcmp(resolution,'1024x768, 60Hz')		display.pixelSize = 0.02880;		display.frameRate = 60;	elseif strcmp(resolution,'1024x768, 75Hz')		display.pixelSize = 0.02880;		display.frameRate = 75;	else		disp(['display resolution property "',resolution,'" not recognized for monitor "',monitor,'".']);	endelseif strcmp(monitor,'NecLcd2000')   %NEC Multisync LCD 2000	if strcmp(position,'room 452')		display.distance = 50;	%53.1	elseif  strcmp(position,'shielded box')		% display.distance = 67.5;      %centimeters , Measured 02.18.98 by HAB		display.distance = 50;      %centimeters, after moving monitor to front of box; 									% Measured ~ 04.07.98 by Alex Huk?  53.1	end		if strcmp(resolution,'640x480, 67Hz')		display.pixelSize = 0.0626;		display.frameRate = 200/3;	elseif strcmp(resolution,'832x624, 75Hz')		display.pixelSize =0.048125;		display.frameRate = 75;	elseif strcmp(resolution,'1024x768, 75Hz')		display.pixelSize = 0.03875;		display.frameRate = 75;	elseif strcmp(resolution,'1280x1024, 74Hz')		display.pixelSize = 0.03125;		display.frameRate = 74;	elseif strcmp(resolution,'1360x1024, 75Hz')		display.pixelSize = 0.028750;		display.frameRate = 75;	else		disp(['display resolution property "',resolution,'" not recognized for monitor "',monitor,'".']);	endelse 	disp(['display monitor property "',monitor,'" not recognized']);end%set display.midDac and display.stepDacdisplay.stepDac = 2^(display.pixelDepth)/display.numColors;  %1 for 8-bit, 4 for 10-bit cardsdisplay.midDac = 2^(display.pixelDepth-1);                   %128 for 8-bit, 512 for 10-bit cards%The old way:%display.maxContrast = 1.0;%display.maxIntensity = 1.0;%load the appropriate gamma table.filename = [monitor,card];homedr= pwd;chdir([machineName,':Applications:Matlab 5.2:MRI:GammaTables']);if exist([filename,'.mat']) == 2	evalstr = (['load ',filename]);	eval(evalstr);	if ~exist('gammaTable')		gammaTable = gamma10 * 1023;	end	display.gammaTable = gammaTable;	disp(['loaded gamma table ',filename]);else	%Stick in linear gamma table.	display.gammaTable = linspace(0,2^display.pixelDepth-1,2^display.pixelDepth)';	disp(['Gamma table "',filename,'" not found.  Using linear gamma table instead.']);	pause(1);endchdir(homedr);