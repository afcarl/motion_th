function img = makeSawtoothImage(display,params)%img = makeSawtoothImage(display,params)m=angle2pix(display,params.size(1));n=angle2pix(display,params.size(2));lowReservedColor = max([display.reservedColor.fbVal])+1;%[x,y] is a mesh grid in visual angle coordinates.[x,y] = meshgrid(linspace(-params.size(2)/2,params.size(2)/2,n),linspace(-params.size(1)/2,params.size(1)/2,m));img = x*cos(params.orientation)+y*sin(params.orientation)+params.spatialPhase/(pi*2*params.spatialFrequency);img = (display.numColors-lowReservedColor-1)*(mod(img,1/params.spatialFrequency)*params.spatialFrequency)+lowReservedColor;if params.fixationPoint 	img=insertFixation(display,img);endimg = uint8(img);